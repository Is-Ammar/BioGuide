@import url('https://fonts.googleapis.com/css2?family=Alan+Sans:wght@400;500;600;700&display=swap');

@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  * { @apply border-slate-300; }
  body {
    background: var(--color-surface-0);
    color: var(--color-text-primary);
    font-family: 'Inter', system-ui, sans-serif;
    -webkit-font-smoothing: antialiased;
  }
  h1, h2, h3, h4, h5, h6 {
    font-family: 'Alan Sans', serif;
    font-weight: 600;
    color: var(--color-text-primary);
  }
  ::selection {
    background: var(--color-accent-primary);
    color: #fff;
  }
}

@layer components {
  .glass {
    background: color-mix(in srgb, var(--color-surface-1) 88%, transparent);
    backdrop-filter: blur(12px) saturate(1.2);
    border: 1px solid var(--color-border-muted);
    color: var(--color-text-primary);
    box-shadow: var(--shadow-soft);
  }
  .glass-dark { /* kept for backwards usage; alias */
    background: color-mix(in srgb, var(--color-surface-2) 90%, transparent);
    backdrop-filter: blur(14px) saturate(1.3);
    border: 1px solid var(--color-border-accent);
    color: var(--color-text-primary);
    box-shadow: var(--shadow-elevated);
  }
  .neon-glow {
    color: var(--color-text-primary);
    text-shadow: 0 0 2px var(--color-accent-primary), 0 0 8px color-mix(in srgb,var(--color-accent-primary) 55%, transparent), 0 0 18px color-mix(in srgb,var(--color-accent-secondary) 45%, transparent);
  }
  .nebula-bg {
    background:
      radial-gradient(ellipse at 20% 50%, color-mix(in srgb,var(--color-accent-primary) 40%, transparent) 0%, transparent 60%),
      radial-gradient(ellipse at 80% 20%, color-mix(in srgb,var(--color-accent-secondary) 30%, transparent) 0%, transparent 55%),
      radial-gradient(ellipse at 40% 80%, color-mix(in srgb,#f97316 25%, transparent) 0%, transparent 60%),
      linear-gradient(135deg, var(--color-surface-0) 0%, color-mix(in srgb,var(--color-surface-2) 70%, var(--color-surface-0)) 50%, var(--color-surface-1) 100%);
    color: var(--color-text-primary);
  }
}

/* We'll enable smooth transitions after first paint via JS (prevent FOUC) */
html.theme-ready * { transition: background-color .25s ease, color .25s ease, border-color .25s ease, box-shadow .25s ease, fill .25s ease, stroke .25s ease; }

/* === SCROLLBAR (theme-aware) === */
/* Firefox */
* {
  scrollbar-width: thin;
  scrollbar-color: var(--scrollbar-thumb) var(--scrollbar-track);
}
/* WebKit */
::-webkit-scrollbar { width: 10px; height: 10px; }
::-webkit-scrollbar-track { background: var(--scrollbar-track); }
::-webkit-scrollbar-thumb {
  background: var(--scrollbar-thumb);
  border-radius: 8px;
  border: 2px solid var(--scrollbar-track); /* creates a gap effect */
  transition: background-color .25s ease, border-color .25s ease;
}
::-webkit-scrollbar-thumb:hover { background: var(--scrollbar-thumb-hover); }


/* Remove hard override of all text colors; allow semantic usage */

/* === Pointer Glow Card Styles === */
/* === LIGHT THEME (default) === */
:root {
  /* base design tokens */
  --radius: 14; --border: 3; --size: 260; --cardblur: 6;
  --backdrop: hsl(210 40% 96% / 0.6);
  --backup-border: var(--backdrop);

  /* surfaces */
  --color-surface-0: #f5f9fb; /* page */
  --color-surface-1: #ffffff; /* card */
  --color-surface-2: #eef3f6; /* elevated */

  /* borders */
  --color-border-muted: rgba(7, 89, 133, 0.18);
  --color-border-accent: rgba(7, 89, 133, 0.42);

  /* text */
  --color-text-primary: #0f172a; /* slate-900 */
  --color-text-secondary: #334155; /* slate-700 */
  --color-text-dim: #64748b; /* slate-500 */

  /* accents */
  --color-accent-primary: #0369a1; /* cosmic-700 */
  --color-accent-secondary: #15803d; /* bio-700 */
  --color-accent-gradient: linear-gradient(90deg,#0369a1,#15803d);

  /* statuses */
  --color-success: #15803d;
  --color-warning: #b45309;
  --color-danger: #b91c1c;

  /* interactive states */
  --color-interactive-bg: rgba(3,105,161,0.08);
  --color-interactive-hover: rgba(3,105,161,0.14);
  --color-interactive-active: rgba(3,105,161,0.24);
  --color-ring-accent: rgba(3,105,161,0.55);

  /* shadows (light) */
  --shadow-soft: 0 1px 2px rgba(0,0,0,0.04), 0 4px 16px -2px rgba(0,0,0,0.06);
  --shadow-elevated: 0 2px 4px rgba(0,0,0,0.06), 0 8px 28px -4px rgba(0,0,0,0.10);

  /* form fields */
  --color-field-bg: #ffffff;
  --color-field-bg-hover: #f1f5f9; /* slate-100-ish */
  --color-field-bg-focus: #eef3f6; /* light subtle */
  --color-field-border: var(--color-border-muted);
  --color-field-border-focus: var(--color-border-accent);

  /* scrollbar (light) */
  --scrollbar-track: color-mix(in srgb, var(--color-surface-1) 85%, transparent);
  --scrollbar-thumb: color-mix(in srgb, var(--color-accent-primary) 55%, var(--color-surface-2));
  --scrollbar-thumb-hover: color-mix(in srgb, var(--color-accent-primary) 70%, var(--color-surface-2));
}

/* === DARK THEME === */
html.theme-dark {
  --backdrop: hsl(0 0% 60% / 0.12);
  --color-surface-0: #02070a;
  --color-surface-1: #031018;
  --color-surface-2: #071c29;
  --color-border-muted: rgba(56,189,248,0.12);
  --color-border-accent: rgba(56,189,248,0.45);
  --color-text-primary: #f2f9fb;
  --color-text-secondary: #b5c6cc;
  --color-text-dim: #6b7b81;
  --color-accent-primary: #38bdf8;
  --color-accent-secondary: #4ade80;
  --color-accent-gradient: linear-gradient(90deg,#38bdf8,#4ade80);
  --color-success: #22c55e; --color-warning: #fbbf24; --color-danger: #ef4444;
  --color-interactive-bg: rgba(56,189,248,0.08);
  --color-interactive-hover: rgba(56,189,248,0.15);
  --color-interactive-active: rgba(56,189,248,0.28);
  --color-ring-accent: rgba(56,189,248,0.55);
  --shadow-soft: 0 2px 4px rgba(0,0,0,0.4), 0 8px 28px -6px rgba(0,0,0,0.7);
  --shadow-elevated: 0 4px 10px rgba(0,0,0,0.55), 0 14px 48px -4px rgba(0,0,0,0.75);

  /* form fields */
  --color-field-bg: rgba(3,16,24,0.85);
  --color-field-bg-hover: rgba(7,28,41,0.85);
  --color-field-bg-focus: rgba(7,28,41,0.95);
  --color-field-border: var(--color-border-muted);
  --color-field-border-focus: var(--color-border-accent);

  /* scrollbar (dark) */
  --scrollbar-track: color-mix(in srgb, var(--color-surface-1) 35%, transparent);
  --scrollbar-thumb: color-mix(in srgb, var(--color-accent-primary) 55%, var(--color-surface-2));
  --scrollbar-thumb-hover: color-mix(in srgb, var(--color-accent-primary) 75%, var(--color-surface-2));
}

/* Auto-respect system on first load before JS sets explicit theme */
@media (prefers-color-scheme: dark) {
  html:not(.theme-light):not(.theme-dark-init) {
    /* Only apply if user hasn't explicitly chosen */
    --backdrop: hsl(0 0% 60% / 0.12);
    --color-surface-0: #02070a;
    --color-surface-1: #031018;
    --color-surface-2: #071c29;
    --color-border-muted: rgba(56,189,248,0.12);
    --color-border-accent: rgba(56,189,248,0.45);
    --color-text-primary: #f2f9fb;
    --color-text-secondary: #b5c6cc;
    --color-text-dim: #6b7b81;
    --color-accent-primary: #38bdf8;
    --color-accent-secondary: #4ade80;
    --color-accent-gradient: linear-gradient(90deg,#38bdf8,#4ade80);
    --color-success: #22c55e; --color-warning: #fbbf24; --color-danger: #ef4444;
    --color-interactive-bg: rgba(56,189,248,0.08);
    --color-interactive-hover: rgba(56,189,248,0.15);
    --color-interactive-active: rgba(56,189,248,0.28);
    --color-ring-accent: rgba(56,189,248,0.55);
    --shadow-soft: 0 2px 4px rgba(0,0,0,0.4), 0 8px 28px -6px rgba(0,0,0,0.7);
    --shadow-elevated: 0 4px 10px rgba(0,0,0,0.55), 0 14px 48px -4px rgba(0,0,0,0.75);

    --color-field-bg: rgba(3,16,24,0.85);
    --color-field-bg-hover: rgba(7,28,41,0.85);
    --color-field-bg-focus: rgba(7,28,41,0.95);
    --color-field-border: var(--color-border-muted);
    --color-field-border-focus: var(--color-border-accent);

    /* scrollbar (auto-dark) */
    --scrollbar-track: color-mix(in srgb, var(--color-surface-1) 35%, transparent);
    --scrollbar-thumb: color-mix(in srgb, var(--color-accent-primary) 55%, var(--color-surface-2));
    --scrollbar-thumb-hover: color-mix(in srgb, var(--color-accent-primary) 75%, var(--color-surface-2));
  }
}

/* Provide isolation so backgrounds don't leak */
.glow-card-wrapper { position: relative; }

[data-glow] {
  --border-size: calc(var(--border, 2) * 1px);
  --spotlight-size: calc(var(--size, 150) * 1px);
  background-image: radial-gradient(
    var(--spotlight-size) var(--spotlight-size) at
    calc(var(--x, 0) * 1px)
    calc(var(--y, 0) * 1px),
    hsl(var(--hue, 210) 100% 70% / var(--bg-spot-opacity, 0.08)), transparent
  );
  background-color: var(--backdrop, transparent);
  background-size: calc(100% + (2 * var(--border-size))) calc(100% + (2 * var(--border-size)));
  background-position: 50% 50%;
  background-attachment: fixed;
  border: var(--border-size) solid var(--backup-border);
  position: relative;
}

[data-glow]::before,
[data-glow]::after {
  pointer-events: none;
  content: "";
  position: absolute;
  inset: calc(var(--border-size) * -1);
  border: var(--border-size) solid transparent;
  border-radius: calc(var(--radius) * 1px);
  background-attachment: fixed;
  background-size: calc(100% + (2 * var(--border-size))) calc(100% + (2 * var(--border-size)));
  background-repeat: no-repeat;
  background-position: 50% 50%;
  mask:
    linear-gradient(transparent, transparent),
    linear-gradient(white, white);
  mask-clip: padding-box, border-box;
  mask-composite: intersect;
}

[data-glow]::before {
  background-image: radial-gradient(
    calc(var(--spotlight-size) * 0.75) calc(var(--spotlight-size) * 0.75) at
    calc(var(--x, 0) * 1px)
    calc(var(--y, 0) * 1px),
    hsl(var(--hue, 210) 100% 55% / var(--border-spot-opacity, 0.9)), transparent 100%
  );
  filter: brightness(1.8);
}

[data-glow]::after {
  background-image: radial-gradient(
    calc(var(--spotlight-size) * 0.5) calc(var(--spotlight-size) * 0.5) at
    calc(var(--x, 0) * 1px)
    calc(var(--y, 0) * 1px),
    hsl(0 0% 100% / var(--border-light-opacity, 0.7)), transparent 100%
  );
}

[data-glow] > [data-glow]:not(:is(a, button)) {
  position: absolute;
  inset: 0;
  will-change: filter;
  opacity: var(--outer, 0.85);
  border-radius: calc(var(--radius) * 1px);
  border-width: calc(var(--border-size) * 20);
  filter: blur(calc(var(--border-size) * 12));
  background: none;
  pointer-events: none;
}

[data-glow] button span[data-glow-text] {
  font-weight: 600;
  background-image: radial-gradient(
    var(--spotlight-size) var(--spotlight-size) at
    calc(var(--x, 0) * 1px)
    calc(var(--y, 0) * 1px),
    hsl(var(--hue, 210) 100% 70% / 0.8), transparent
  );
  background-color: var(--backdrop, transparent);
  background-position: 50% 50%;
  background-attachment: fixed;
  -webkit-background-clip: text;
  background-clip: text;
  filter: brightness(1.4);
  color: transparent;
}

/* Utility when a card is selected to intensify */
.glow-selected[data-glow]::before { filter: brightness(2.2) saturate(1.3); }
.glow-selected[data-glow] { --bg-spot-opacity: 0.14; }